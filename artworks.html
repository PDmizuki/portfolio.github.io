<!DOCTYPE html>
<html lang="ja">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
  <title>Nature inspire | Art Index</title>

  <!-- CSS -->
  <link rel="stylesheet" href="css/noise.css">
  <link rel="stylesheet" href="css/all.css">
  <link rel="stylesheet" href="css/gallery.css">
  <link rel="stylesheet" href="css/mobile.css">
  <link rel="stylesheet" href="css/footer.css">
  <link rel="stylesheet" href="css/menu.css">

  <!-- JS -->
  <script src="https://code.jquery.com/jquery-3.6.4.min.js" crossorigin="anonymous"></script>

  <!-- 背景用 JavaScript -->
  <script src="js/jquery.ripples-min.js"></script>
  <script src="js/bg_wave.js"></script>

  <script src="js/cursor.js"></script>
  <script src="js/page-nation.js"></script>
  <script src="js/loading.js"></script>
  <script src="js/menu.js"></script>
  <script src="js/page-nation.js"></script>
  <script src="js/artworks-date.js"></script>
  <script src="js/footer.js"></script>

  <!-- Font -->
  <link rel="stylesheet" href="https://use.typekit.net/meg7mel.css">

  <!-- ✅ SEO強化 -->
  <meta name="description"
    content="Nature inspire は、自然とアートの融合をテーマにしたポートフォリオサイトです。繊細なデザインとインスピレーションを通して、独自のビジュアル表現を紹介します。">
  <meta name="keywords" content="ポートフォリオ, 自然, アート, Webデザイン, 作品集, クリエイティブ, Nature inspire">
  <meta name="author" content="あなたの名前（またはブランド名）">
  <link rel="canonical" href="https://mizukioyama.github.io/"> <!-- ご自身のURLに差し替えてください -->

  <!-- OGP（SNSシェア用） -->
  <meta property="og:title" content="Nature inspire | 自然とアートのポートフォリオ">
  <meta property="og:description" content="自然から着想を得たアート作品をまとめたポートフォリオサイト。">
  <meta property="og:type" content="website">
  <meta property="og:url" content="https://mizukioyama.github.io/">
  <meta property="og:image" content="https://mizukioyama.github.io/images/ogp.jpg"> <!-- OGP画像を用意してください -->
  <meta property="og:site_name" content="Nature inspire">

  <!-- Twitterカード -->
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:title" content="Nature inspire | 自然とアートのポートフォリオ">
  <meta name="twitter:description" content="自然から着想を得たアート作品をまとめたポートフォリオサイト。">
  <meta name="twitter:image" content="https://mizukioyama.github.io/images/ogp.jpg">

  <!-- Favicon -->
  <link rel="icon" href="favicon.ico">

  <!-- キャッシュ制御 -->
  <meta http-equiv="Cache-Control" content="no-cache, no-store, must-revalidate">
  <meta http-equiv="Pragma" content="no-cache">
  <meta http-equiv="Expires" content="0">

  <!-- セキュリティ -->
  <meta name="referrer" content="strict-origin">
  <meta http-equiv="X-Content-Type-Options" content="nosniff">
  <meta http-equiv="X-XSS-Protection" content="1; mode=block">

  <!-- Content Security Policy -->
  <meta http-equiv="Content-Security-Policy" content="
        default-src 'self';
        script-src 'self' https://code.jquery.com https://cdn.jsdelivr.net 'unsafe-inline';
        style-src 'self' 'unsafe-inline' https://use.typekit.net;
        font-src 'self' https://use.typekit.net https://fonts.gstatic.com;
        img-src 'self' data: https:;
        connect-src 'self';
        object-src 'none';
        ">

  <style>
    .accordion {
      margin-top: 2rem;
      padding: 0.5rem 1rem;
      border-top: 1px solid var(--inv);
    }

    #accordion-toggle {
      cursor: pointer;
      border: none;
      font-size: 1.2rem;
      text-align: left;
      width: 100%;
      padding: 0.5rem;
      color: inherit;
    }

    #accordion-toggle::after {
      content: "▼";
      float: right;
      transition: transform 0.3s ease;
    }

    #accordion-toggle.open::after {
      transform: rotate(180deg);
    }

    #accordion-content {
      padding-top: 1rem;
    }

    #related-filter {
      display: flex;
      gap: 1rem;
      margin-bottom: 1rem;
      list-style: none;
      padding: 0;
      flex-wrap: wrap;
    }

    #related-filter li {
      cursor: pointer;
      padding: 0.3rem 0.8rem;
      border-bottom: 2px solid transparent;
    }

    #related-filter li.active {
      border-color: #000;
      font-weight: bold;
    }

    .works-list {
      display: grid;
      grid-template-columns: repeat(3, 1fr);
      /* ← 3カラム固定 */
      gap: 1.5rem;
      max-height: 500px;
      overflow-y: auto;
      padding: 1rem;
    }

    .work-item {
      background-color: rgba(46, 46, 46, 0.25);
      backdrop-filter: blur(0);
      border: 1px solid var(--text);
      padding: 1rem;
      display: flex;
      flex-direction: column;
      width: 430px;
      gap: 0.5rem;
      box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
    }

    .work-item img {
      width: 100%;
      height: auto;
      object-fit: cover;
      border-radius: 4px;
    }

    .work-info h3 {
      margin: 0.5rem 0 0;
      font-size: 1rem;
    }

    .work-info p.category {
      font-size: 0.85rem;
      color: #666;
    }

    .work-info p.caption {
      font-size: 0.9rem;
      line-height: 1.4;
    }

    @media (max-width: 900px) {
      .works-list {
        grid-template-columns: repeat(2, 1fr);
      }
    }

    @media (max-width: 600px) {
      .works-list {
        grid-template-columns: 1fr;
      }
    }
  </style>

</head>

<body data-current-page="1" data-current-category="all">
  <div id="header-container"></div>
  <div class="ripples"></div>


  <main class="gallery">
    <h1 class="noise">Art Index</h1>
    <p class="noise" style="width: 100%;">Nature inspire</p>
    <div class="scroll"></div>

    <div id="work-detail"></div>

    <div class="accordion">
      <button id="accordion-toggle" class="noise">▼ 関連作品を表示</button>
      <div id="accordion-content" style="display: none;">
        <ul id="related-filter">
          <li data-category="all" class="active noise">All</li>
          <li data-category="digital" class="noise">Digital</li>
          <li data-category="analog" class="noise">Analog</li>
          <li data-category="unreleased" class="noise">Unreleased</li>
        </ul>
        <div id="works-list" class="works-list"></div>
      </div>
    </div>


    <!-- ページネーション -->
    <div id="pagination"></div>

  </main>
  <div id="footer-container"></div>

  <script>
    document.addEventListener("DOMContentLoaded", () => {
      const detailContainer = document.getElementById("work-detail");
      const listContainer = document.getElementById("works-list");
      const accordionToggle = document.getElementById("accordion-toggle");
      const accordionContent = document.getElementById("accordion-content");
      const categoryTabs = document.querySelectorAll("#related-filter li");

      const data = localStorage.getItem("selectedWork");
      if (!data) {
        detailContainer.textContent = "データがありません。";
        return;
      }

      const selectedWork = JSON.parse(data);
      const lang = localStorage.getItem("lang") || "ja";

      // 現在の作品を表示
      detailContainer.innerHTML = `
    <div class="work-img">
      <span style="width: 120px; position: relative; left: -4.75rem; bottom: -13.5vmin; letter-spacing: 0.05rem; transform: rotate(-90deg);" class="noise">
        ${selectedWork.category.join(" / ")}
      </span>
      <img src="${selectedWork.img}" alt="${selectedWork.title[lang]}">
      <span class="dli-external-link">©Oyama</span>
      <h3 class="noise">${selectedWork.title[lang]}</h3>
      <p>${selectedWork.caption[lang]}</p>
    </div>
  `;

      // 関連作品の描画関数（カテゴリフィルタ付き）
      function renderRelated(category = "all") {
        const filtered = artworks.filter(work => {
          if (work.title[lang] === selectedWork.title[lang]) return false;
          if (category === "all") {
            return work.category.some(cat => selectedWork.category.includes(cat));
          } else {
            return work.category.includes(category);
          }
        });

        listContainer.innerHTML = filtered.length
          ? ""
          : "<p>関連する作品がありません。</p>";

        filtered.forEach(work => {
          const caption = work.caption[lang];
          const truncated = caption.length > 120 ? caption.substring(0, 120) + "..." : caption;

          const div = document.createElement("div");
          div.className = "work-item";
          div.innerHTML = `
        <div class="work-img">
          <img src="${work.img}" alt="${work.title[lang]}">
        </div>
        <div class="work-info">
          <h3>${work.title[lang]}</h3>
          <p class="category">${work.category.join(" / ")}</p>
          <p class="caption">${truncated}</p>
        </div>
      `;
          listContainer.appendChild(div);
        });
      }

      // 初回描画（Allカテゴリ）
      renderRelated();

      // タブクリックでカテゴリ切り替え
      categoryTabs.forEach(tab => {
        tab.addEventListener("click", () => {
          categoryTabs.forEach(t => t.classList.remove("active"));
          tab.classList.add("active");
          const selected = tab.dataset.category;
          renderRelated(selected);
        });
      });

      // アコーディオン開閉
      accordionToggle.addEventListener("click", () => {
        const isOpen = accordionContent.style.display === "block";
        accordionContent.style.display = isOpen ? "none" : "block";
        accordionToggle.classList.toggle("open", !isOpen);
      });
    });
  </script>



  <script>
    document.addEventListener("DOMContentLoaded", () => {
      const container = document.getElementById("works-list");
      const filterButtons = document.querySelectorAll("#works-filter li");
      let selectedCategory = "all";

      // フィルタークリック時の処理
      filterButtons.forEach(btn => {
        btn.addEventListener("click", () => {
          selectedCategory = btn.dataset.category;

          filterButtons.forEach(b => b.classList.remove("active"));
          btn.classList.add("active");

          renderWorks();
        });
      });

      // 作品を表示
      function renderWorks() {
        const lang = localStorage.getItem("lang") || "ja";

        // ✅ artworks 変数は別スクリプトで定義 or fetch で取得してください
        const filtered = selectedCategory === "all"
          ? artworks
          : artworks.filter(work => work.category.includes(selectedCategory));

        container.innerHTML = "";

        if (filtered.length === 0) {
          container.innerHTML = "<p>該当する作品がありません。</p>";
          return;
        }

        filtered.forEach(work => {
          const caption = work.caption[lang];
          const truncated = caption.length > 120 ? caption.substring(0, 120) + "..." : caption;

          const div = document.createElement("div");
          div.className = "work-item";
          div.innerHTML = `
        <div class="work-img">
          <img src="${work.img}" alt="${work.title[lang]}">
        </div>
        <div class="work-info">
          <h3>${work.title[lang]}</h3>
          <p class="category">${work.category.join(" / ")}</p>
          <p class="caption">${truncated}</p>
        </div>
      `;
          container.appendChild(div);
        });
      }

      renderWorks();
    });

  </script>
</body>

</html>